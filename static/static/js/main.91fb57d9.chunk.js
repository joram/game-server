(this.webpackJsonpgame=this.webpackJsonpgame||[]).push([[0],{33:function(t,e,n){t.exports=n(47)},38:function(t,e,n){},39:function(t,e,n){},47:function(t,e,n){"use strict";n.r(e);var a=n(0),i=n.n(a),o=n(26),s=n.n(o),r=(n(38),n(3)),c=n(2),l=n(5),u=n(4),p=n(27),h=n.n(p),m=(n(39),n(28)),d=n.n(m),f=n(15),v=n.n(f),y=n(20),b=n.n(y),g=n(29);function k(){var t=window.location.href.split("/")[2];return"localhost:3000"===t?"localhost:2305":t}function E(){return"localhost:2305"===k()?"ws":"wss"}function j(){return"localhost:2305"===k()?"http":"https"}function x(t){return new Promise((function(e){return setTimeout(e,t)}))}var O=new(function(){function t(){var e=this;Object(r.a)(this,t),this.objectEventBus=n(45)();var a="".concat(E(),"://").concat(k(),"/objects");console.log(a),this.ws=new WebSocket(a),this.ws.onopen=function(){console.log("connected to generic ws")},this.ws.onmessage=function(t){var n=JSON.parse(t.data);e.processMessage(n)},this.ws.onclose=function(){console.log("disconnected generic ws")}}return Object(c.a)(t,[{key:"sendAccessToken",value:function(t,e,n,a,i){var o=this;this.waitForConn((function(){var s='{"accessToken":"'.concat(t,'", "googleId":"').concat(e,'", "email":"').concat(n,'", "firstName":"').concat(a,'", "lastName":"').concat(i,'"}');o.ws.send(s)}))}},{key:"sendBackpackRequest",value:function(){var t=this;this.waitForConn((function(){t.ws.send('{"backpack":"please"}')}))}},{key:"sendFullStateRequest",value:function(){var t=this;this.waitForConn((function(){t.ws.send('{"full_state":"please"}')}))}},{key:"sendPlayerMove",value:function(t){var e=this;this.waitForConn((function(){e.ws.send('{"direction":"'.concat(t,'"}'))}))}},{key:"equipItem",value:function(t){var e=this;this.waitForConn((function(){e.ws.send('{"equip_item":'.concat(t,"}"))}))}},{key:"unequipItem",value:function(t){var e=this;this.waitForConn((function(){e.ws.send('{"unequip_item":'.concat(t,"}"))}))}},{key:"dropItem",value:function(t){var e=this;this.waitForConn((function(){e.ws.send('{"drop_item":'.concat(t,"}"))}))}},{key:"waitForConn",value:function(){var t=Object(g.a)(b.a.mark((function t(e){return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(1===this.ws.readyState){t.next=5;break}return t.next=3,x(1);case 3:t.next=0;break;case 5:e();case 6:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"processMessage",value:function(t){return void 0!==t.equipped_image?(console.log("item",t),void this.objectEventBus.emit("item",null,t)):void 0===t.playerId?void 0!==t.type?(console.log("monster",t),void this.objectEventBus.emit("monster",null,t)):void console.log("unknown msg",t):void this.objectEventBus.emit("player_id",null,t)}}]),t}()),w=function(t){Object(l.a)(n,t);var e=Object(u.a)(n);function n(){var t;Object(r.a)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(t=e.call.apply(e,[this].concat(i))).state={id:void 0,playerPosition:{x:0,y:0}},t.is_mounted=!1,t.debouncedMovePlayer=d.a.debounce((function(e,n,a){t.movePlayer(e,n)}),350,{leading:!0,maxWait:350}),t}return Object(c.a)(n,[{key:"componentWillUnmount",value:function(){this.is_mounted=!1}},{key:"componentDidMount",value:function(){var t=this;this.is_mounted=!0,O.sendFullStateRequest(),console.log("player",this.state.id," pos is",this.state.playerPosition),O.objectEventBus.on("player_id",(function(e){if(t.is_mounted){var n=t.state;n.id=e.playerId,t.setState(n)}})),O.objectEventBus.on("monster",(function(e){if(t.is_mounted){if(e.id===t.state.id){var n=t.state;n.playerPosition.x=e.x,n.playerPosition.y=e.y,t.setState(n)}var a=t.state,i=a.playerPosition;if("player"===e.type){a.playerPosition=i,a.nextPlayerPosition=i,t.setState(a),t.props.background.current.updateChunks();var o=t.props.app.state;o.playerPosition=i,t.props.app.setState(o)}}}))}},{key:"movePlayer",value:function(t,e){"e"===t?this.props.app.setPage("inventory"):("w"===t&&(t="up"),"a"===t&&(t="left"),"s"===t&&(t="down"),"d"===t&&(t="right"),this.props.background.current.updateChunks(),O.sendPlayerMove(t))}},{key:"render",value:function(){var t=this;return i.a.createElement(i.a.Fragment,null,i.a.createElement(v.a,{handleKeys:["left","right","up","down","w","a","s","d","e"],onKeyEvent:function(e,n){t.debouncedMovePlayer(e,n,100)}}),this.props.children)}}]),n}(i.a.Component),_=n(23),S=function(t){Object(l.a)(n,t);var e=Object(u.a)(n);function n(){return Object(r.a)(this,n),e.apply(this,arguments)}return Object(c.a)(n,[{key:"isSolid",value:function(){return this.props.pixel.g>180}},{key:"render",value:function(){var t=this.props.pixel,e="rgb(".concat(t.r,", ").concat(t.g,", ").concat(t.b,")");return this.isSolid()&&(e="rgb(0, 80, 0)"),i.a.createElement("div",{style:{width:"50px",height:"50px",left:"".concat(50*(t.x-this.props.chunkPosition.x),"px"),top:"".concat(50*(t.y-this.props.chunkPosition.y),"px"),backgroundColor:e,position:"absolute"}})}}]),n}(i.a.Component),C=function(t){Object(l.a)(n,t);var e=Object(u.a)(n);function n(){var t;Object(r.a)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(t=e.call.apply(e,[this].concat(i))).SIZE=50,t.chunk={},t.state={},t}return Object(c.a)(n,[{key:"backgroundSquares",value:function(){var t=this,e=[];return this.props.data.pixels.forEach((function(n){e.push(i.a.createElement(S,{key:n.x+"_"+n.y,pixel:n,chunkPosition:{x:t.props.data.x,y:t.props.data.y},playerPosition:t.props.playerPosition}))})),e}},{key:"render",value:function(){var t=this.props.x,e=this.props.y,n=Math.ceil(window.innerHeight/50),a=Math.ceil(window.innerWidth/50),o=-this.props.playerPosition.x+Math.floor(a/2),s=-this.props.playerPosition.y+Math.floor(n/2);return i.a.createElement("div",{className:"chunk",style:{position:"absolute",border:"solid thin black",width:"".concat(this.SIZE*this.chunk.size,"px"),height:"".concat(this.SIZE*this.chunk.size,"px"),backgroundColor:"pink",left:50*(t+o)+"px",top:50*(e+s)+"px"}},i.a.createElement("div",{className:"squares"},this.backgroundSquares()))}}]),n}(i.a.Component),I=function(t){Object(l.a)(n,t);var e=Object(u.a)(n);function n(){var t;Object(r.a)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(t=e.call.apply(e,[this].concat(i))).CHUNKSIZE=10,t.state={playerPosition:{x:-99,y:-99},chunkData:{}},t}return Object(c.a)(n,[{key:"componentDidMount",value:function(t){this.updateChunks()}},{key:"requestChunk",value:function(t,e){var n=this;if(void 0===this.state.chunkData["".concat(t,"_").concat(e)]){var a=this.state;a.chunkData["".concat(t,"_").concat(e)]={pixels:[],objects:[]},this.setState(a);var i="".concat(j(),"://").concat(k(),"/chunks?x=").concat(t,"&y=").concat(e);fetch(i).then((function(t){return t.json()})).then((function(a){var i=n.state;i.chunkData["".concat(t,"_").concat(e)]=a,n.setState(i)}))}}},{key:"updateChunks",value:function(){var t=this,e=Math.ceil(window.innerHeight/50),n=Math.ceil(window.innerWidth/50),a=this.playerPosition(),i=Math.floor(a.x-n/2),o=Math.floor(a.y-e/2),s=Math.ceil(a.x+n/2),r=Math.ceil(a.y+e/2);i=i-i%this.CHUNKSIZE-this.CHUNKSIZE,o=o-o%this.CHUNKSIZE-this.CHUNKSIZE,s=s+s%this.CHUNKSIZE+this.CHUNKSIZE,r=r+r%this.CHUNKSIZE+this.CHUNKSIZE;var c=Math.ceil((s-i)/this.CHUNKSIZE),l=Math.ceil((r-o)/this.CHUNKSIZE),u=Object(_.a)(Array(c).keys()),p=Object(_.a)(Array(l).keys());u.forEach((function(e){p.forEach((function(n){void 0===t.state.chunkData["".concat(e,"_").concat(n)]&&t.requestChunk(i+e*t.CHUNKSIZE,o+n*t.CHUNKSIZE)}))}))}},{key:"playerPosition",value:function(){return this.props.app.playerPosition()}},{key:"isSolidAt",value:function(t){var e=Math.floor(t.x/this.CHUNKSIZE)*this.CHUNKSIZE,n=Math.floor(t.y/this.CHUNKSIZE)*this.CHUNKSIZE,a=this.state.chunkData["".concat(e,"_").concat(n)];if(void 0===a)return!1;var i=!1;return a.pixels.forEach((function(e){Math.ceil(t.x)===e.x&&Math.ceil(t.y)===e.y&&e.g>180&&(i=!0)})),i}},{key:"render",value:function(){var t=this,e=[];return Object.keys(this.state.chunkData).forEach((function(n){var a=t.state.chunkData[n],o=i.a.createElement(C,{x:a.x,y:a.y,key:n,playerPosition:t.playerPosition(),data:a,objectEventBus:t.props.objectEventBus});e.push(o)})),i.a.createElement("div",{id:"chunks"},e)}}]),n}(i.a.Component),P=function(t){Object(l.a)(n,t);var e=Object(u.a)(n);function n(t){var a;return Object(r.a)(this,n),(a=e.call(this,t)).state={monster:{x:0,y:0}},a.is_mounted=!1,a.state.monster=t.monster,a}return Object(c.a)(n,[{key:"isSolid",value:function(){return this.props.monster.solid}}]),Object(c.a)(n,[{key:"componentWillUnmount",value:function(){this.is_mounted=!1}},{key:"componentDidMount",value:function(){var t=this;this.is_mounted=!0,O.objectEventBus.on("monster",(function(e){if(t.is_mounted&&t.props.id===e.id){var n=t.state;n.monster=e,t.setState(n)}}))}},{key:"render",value:function(){var t=this,e=this.state.monster,n=this.props.size,a=e.x,o=e.y,s=Math.ceil(window.innerHeight/50),r=Math.ceil(window.innerWidth/50),c=-this.props.playerPosition.x+Math.floor(r/2),l=-this.props.playerPosition.y+Math.floor(s/2),u=[];e.images.forEach((function(a){u.push(i.a.createElement("img",{style:{width:"".concat(n,"px"),height:"".concat(n,"px"),position:"absolute",left:"0px",top:"0px"},key:"".concat(e.id,"_img_").concat(u.length),src:"".concat(j(),"://").concat(k()).concat(a),alt:t.props.monster.type}))}));var p=0;return"player"===this.props.monster.type&&(p=10),i.a.createElement("div",{style:{position:"absolute",width:n+"px",height:n+"px",zIndex:p,left:n*(a+c)+"px",top:n*(o+l)+"px"}},u)}}]),n}(i.a.Component),M=function(t){Object(l.a)(n,t);var e=Object(u.a)(n);function n(){var t;Object(r.a)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(t=e.call.apply(e,[this].concat(i))).SIZE=50,t.state={monsters:{}},t.is_mounted=!1,t}return Object(c.a)(n,[{key:"componentWillUnmount",value:function(){this.is_mounted=!1}},{key:"componentDidMount",value:function(){var t=this;this.is_mounted=!0,O.objectEventBus.on("monster",(function(e){if(t.is_mounted){var n=t.state;"remove"===e.action?delete n.monsters[e.id]:n.monsters[e.id]=e,t.setState(n)}}))}},{key:"isSolidAt",value:function(t){var e=!1;return Object.values(this.state.monsters).forEach((function(n){Math.ceil(t.x)===n.x&&Math.ceil(t.y)===n.y&&(e=e||n.solid)})),console.log(e),e}},{key:"render",value:function(){var t=this,e={x:0,y:0};function n(t,n){return i.a.createElement(P,{monster:t,key:t.id,id:t.id,size:n,playerPosition:e})}null!==this.props.player.current&&(e=this.props.player.current.state.playerPosition);var a=[];return Object.values(this.state.monsters).forEach((function(e){"player"!==e.type&&a.push(n(e,t.SIZE))})),Object.values(this.state.monsters).forEach((function(e){"player"===e.type&&a.push(n(e,t.SIZE))})),i.a.createElement("div",{className:"objects"},a)}}]),n}(i.a.Component),N=function(t){Object(l.a)(n,t);var e=Object(u.a)(n);function n(t){var a;return Object(r.a)(this,n),(a=e.call(this,t)).state={item:{x:0,y:0}},a.is_mounted=!1,a.state.item=t.item,a}return Object(c.a)(n,[{key:"componentWillUnmount",value:function(){this.is_mounted=!1}},{key:"componentDidMount",value:function(){var t=this;this.is_mounted=!0,O.objectEventBus.on("item",(function(e){if(t.is_mounted&&t.props.id===e.id){var n=t.state;n.item=e,t.setState(n)}}))}},{key:"render",value:function(){if(this.state.item.is_carried)return null;var t=this.state.item,e=this.props.size,n=t.x,a=t.y,o=Math.ceil(window.innerHeight/50),s=Math.ceil(window.innerWidth/50),r=-this.props.playerPosition.x+Math.floor(s/2),c=-this.props.playerPosition.y+Math.floor(o/2);return i.a.createElement("div",{style:{position:"absolute",width:e+"px",height:e+"px",zIndex:0,left:e*(n+r)+"px",top:e*(a+c)+"px"}},i.a.createElement("img",{style:{width:"".concat(e,"px"),height:"".concat(e,"px"),position:"absolute",left:"0px",top:"0px"},src:"".concat(j(),"://").concat(k()).concat(this.props.item.dropped_image),alt:this.props.item.type}))}}]),n}(i.a.Component),D=function(t){Object(l.a)(n,t);var e=Object(u.a)(n);function n(){var t;Object(r.a)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(t=e.call.apply(e,[this].concat(i))).SIZE=50,t.state={items:{}},t.is_mounted=!1,t}return Object(c.a)(n,[{key:"componentWillUnmount",value:function(){this.is_mounted=!1}},{key:"componentDidMount",value:function(){var t=this;this.is_mounted=!0,O.objectEventBus.on("item",(function(e){if(t.is_mounted){var n=t.state;"remove"===e.action?delete n.items[e.id]:n.items[e.id]=e,t.setState(n)}}))}},{key:"render",value:function(){var t=this,e={x:0,y:0};function n(t,n){return i.a.createElement(N,{playerPosition:e,item:t,key:t.id,id:t.id,size:n})}null!==this.props.player.current&&(e=this.props.player.current.state.playerPosition);var a=[];return Object.values(this.state.items).forEach((function(e){"player"!==e.type&&a.push(n.bind(t)(e,t.SIZE,t.props.objectEventBus))})),Object.values(this.state.items).forEach((function(e){"player"===e.type&&a.push(n(e,t.SIZE,t.props.objectEventBus))})),i.a.createElement("div",{className:"objects"},a)}}]),n}(i.a.Component),q=n(48).v4,U=function(t){Object(l.a)(n,t);var e=Object(u.a)(n);function n(){return Object(r.a)(this,n),e.apply(this,arguments)}return Object(c.a)(n,[{key:"render",value:function(){return i.a.createElement("div",{className:"chat_message",style:{color:"white"}},this.props.message.from.substr(1,6),": ",this.props.message.message)}}]),n}(i.a.Component),Z=(i.a.Component,n(9)),B=n(13),K=n(50),H=n(51),A=n(31),F=n(53),W=n(52),T={1:"s1",2:"s2",3:"s3",4:"s4",5:"s5",6:"s6",7:"s7",8:"s8",BACKPACK:"backpack",GROUND:"ground"},z=function(t){Object(l.a)(n,t);var e=Object(u.a)(n);function n(t){var a;return Object(r.a)(this,n),a=e.call(this,t),O.sendBackpackRequest(),a}return Object(c.a)(n,[{key:"render",value:function(){var t=this;return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{style:{textAlign:"center"}},i.a.createElement("div",{style:{float:"left",width:"300px"}},"Equipped"),i.a.createElement("div",{style:{float:"left",width:"300px"}},"Backpack"),i.a.createElement("div",{style:{float:"left",width:"300px"}},"Ground")),i.a.createElement("div",{style:{top:"20px",position:"absolute"}},i.a.createElement(K.a,{backend:A.a},i.a.createElement($,null),i.a.createElement(L,null),i.a.createElement(Q,null))),i.a.createElement(v.a,{handleKeys:["esc","e"],onKeyEvent:function(e,n){t.props.app.setPage("game")}}))}}]),n}(i.a.Component);function R(t){var e=Object(F.a)({item:{type:T[t.item.allowed_slot]},end:function(e,n){var a=n.getDropResult();e&&a&&("backpack"===a.name?O.unequipItem(t.item.id):"ground"===a.name?O.dropItem(t.item.id):O.equipItem(t.item.id))},collect:function(t){return{isDragging:t.isDragging()}}}),n=Object(B.a)(e,3),a=(n[0].isDragging,n[1]),o=n[2];return i.a.createElement(i.a.Fragment,null,i.a.createElement(H.a,{connect:o,src:t.item.dropped_image}),i.a.createElement("div",{ref:a,style:Object(Z.a)({},t.style)},i.a.createElement("img",{src:"".concat(j(),"://").concat(k(),"/").concat(t.item.dropped_image),alt:t.item.name})))}function G(t){var e=Object(W.a)({accept:T[t.slot],drop:function(){return{name:"slot ".concat(t.slot)}},collect:function(t){return{isOver:t.isOver(),canDrop:t.canDrop()}}}),n=Object(B.a)(e,2),a=n[0],o=a.canDrop,s=a.isOver,r=n[1],c="#222";o&&s?c="darkgreen":o&&(c="darkkhaki");var l=null;return void 0!==t.item&&(l=i.a.createElement(R,{item:t.item,style:Object(Z.a)(Object(Z.a)({},t.style),{},{top:"10px",left:"10px"})})),i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{ref:r,style:Object(Z.a)(Object(Z.a)({},t.style),{},{backgroundColor:c})},i.a.createElement("img",{style:{width:"50px",height:"50px"},src:"".concat(j(),"://").concat(k(),"/images/gui/tab_unselected.png"),alt:"slot ".concat(t.slot)})),l)}function X(t){var e=Object(W.a)({accept:Object.values(T),drop:function(){return{name:"backpack"}},collect:function(t){return{isOver:t.isOver(),canDrop:t.canDrop()}}}),n=Object(B.a)(e,2),a=n[0],o=a.canDrop,s=a.isOver,r=n[1],c="#222";o&&s?c="darkgreen":o&&(c="darkkhaki");return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{ref:r,style:{width:"100%",height:"100%",border:"solid thin black",backgroundColor:c}}),null)}function J(t){var e=Object(W.a)({accept:Object.values(T),drop:function(){return{name:"ground"}},collect:function(t){return{isOver:t.isOver(),canDrop:t.canDrop()}}}),n=Object(B.a)(e,2),a=n[0],o=a.canDrop,s=a.isOver,r=n[1],c="#222";o&&s?c="darkgreen":o&&(c="darkkhaki");return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{ref:r,style:{width:"100%",height:"100%",border:"solid thin black",backgroundColor:c}}),null)}var L=function(t){Object(l.a)(n,t);var e=Object(u.a)(n);function n(){var t;Object(r.a)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(t=e.call.apply(e,[this].concat(i))).state={items:{}},t.is_mounted=!1,t}return Object(c.a)(n,[{key:"componentWillUnmount",value:function(){this.is_mounted=!1}},{key:"componentDidMount",value:function(){var t=this;this.is_mounted=!0,O.objectEventBus.on("item",(function(e){if(t.is_mounted){var n=t.state;e.is_carried&&!e.is_equipped?n.items[e.id]=e:delete n.items[e.id],t.setState(n)}}))}},{key:"render",value:function(){var t=[];return Object.values(this.state.items).forEach((function(e){t.push(i.a.createElement(R,{item:e,key:e.id}))})),i.a.createElement("div",{style:{left:"300px",width:"300px",height:"290px",position:"absolute",border:"solid thin black"}},i.a.createElement(X,null),i.a.createElement("div",{style:{position:"absolute",top:0,left:0}},t))}}]),n}(i.a.Component),$=function(t){Object(l.a)(n,t);var e=Object(u.a)(n);function n(){var t;Object(r.a)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(t=e.call.apply(e,[this].concat(i))).state={items:{}},t.is_mounted=!1,t}return Object(c.a)(n,[{key:"componentWillUnmount",value:function(){this.is_mounted=!1}},{key:"componentDidMount",value:function(){var t=this;this.is_mounted=!0,O.objectEventBus.on("item",(function(e){if(t.is_mounted){var n=t.state;e.is_carried&&e.is_equipped?n.items[e.equipped_slot]=e:delete n.items[e.allowed_slot],t.setState(n)}}))}},{key:"render",value:function(){var t={position:"absolute",width:"200px",height:"200px",left:"50px",top:"40px"},e=[];return Object.values(this.state.items).forEach((function(n){e.push(i.a.createElement("img",{style:t,src:"".concat(j(),"://").concat(k(),"/").concat(n.equipped_image),alt:"silhouette",key:n.id}))})),i.a.createElement("div",{style:{width:"300px",height:"290px",position:"absolute",border:"solid thin black"}},i.a.createElement("img",{style:t,src:"".concat(j(),"://").concat(k(),"/images/player/base/human_m.png"),alt:"silhouette"}),e,i.a.createElement(G,{style:{position:"absolute",left:"0px"},slot:1,item:this.state.items[1]}),i.a.createElement(G,{style:{position:"absolute",transform:"scaleX(-1)",right:"0px"},slot:2,item:this.state.items[2]}),i.a.createElement("div",{style:{position:"absolute",top:"80px",width:"100%"}},i.a.createElement(G,{style:{position:"absolute",left:"0px"},slot:3,item:this.state.items[3]}),i.a.createElement(G,{style:{position:"absolute",transform:"scaleX(-1)",right:"0px"},slot:4,item:this.state.items[4]})),i.a.createElement("div",{style:{position:"absolute",top:"160px",width:"100%"}},i.a.createElement(G,{style:{position:"absolute",left:"0px"},slot:5}),i.a.createElement(G,{style:{position:"absolute",transform:"scaleX(-1)",right:"0px"},slot:6})),i.a.createElement("div",{style:{position:"absolute",top:"240px",width:"100%"}},i.a.createElement(G,{style:{position:"absolute",left:"0px"},slot:7}),i.a.createElement(G,{style:{position:"absolute",transform:"scaleX(-1)",right:"0px"},slot:8})))}}]),n}(i.a.Component),Q=function(t){Object(l.a)(n,t);var e=Object(u.a)(n);function n(){var t;Object(r.a)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(t=e.call.apply(e,[this].concat(i))).state={items:{}},t.is_mounted=!1,t}return Object(c.a)(n,[{key:"componentWillUnmount",value:function(){this.is_mounted=!1}},{key:"componentDidMount",value:function(){var t=this;this.is_mounted=!0,O.objectEventBus.on("item",(function(e){if(t.is_mounted){var n=t.state;e.is_carried?(delete n.items[e.allowed_slot],delete n.items[e.equipped_slot],delete n.items[-1]):n.items[e.equipped_slot]=e,t.setState(n)}}))}},{key:"render",value:function(){var t=[];return Object.values(this.state.items).forEach((function(e){t.push(i.a.createElement(R,{item:e,key:e.id}))})),i.a.createElement("div",{style:{left:"600px",width:"300px",height:"290px",position:"absolute",border:"solid thin black"}},i.a.createElement(J,null),i.a.createElement("div",{style:{position:"absolute",top:0,left:0}},t))}}]),n}(i.a.Component),V=z,Y=function(t){Object(l.a)(n,t);var e=Object(u.a)(n);function n(t){var a;return Object(r.a)(this,n),(a=e.call(this,t)).state={accessToken:null,googleId:null,email:"",firstName:"",lastName:"",page:"game"},a.background=i.a.createRef(),a.monsters=i.a.createRef(),a.items=i.a.createRef(),a.player=i.a.createRef(),a}return Object(c.a)(n,[{key:"playerPosition",value:function(){return null===this.player.current?{x:0,y:0}:this.player.current.state.playerPosition}},{key:"loginSuccess",value:function(t){var e=this.state;e.accessToken=t.accessToken,e.googleId=t.googleId,e.firstName=t.profileObj.givenName,e.lastName=t.profileObj.familyName,e.email=t.profileObj.email,O.sendAccessToken(e.accessToken,e.googleId,e.email,e.firstName,e.lastName),this.setState(e)}},{key:"renderLogin",value:function(){return i.a.createElement("div",{style:{margin:"auto",width:"200px",paddingTop:"200px"}},i.a.createElement(h.a,{clientId:"662193159992-4fv4hq3q25mkerlt0eqqr1ii670ogugr.apps.googleusercontent.com",onSuccess:this.loginSuccess.bind(this),isSignedIn:!0}))}},{key:"setPage",value:function(t){var e=this.state;e.page=t,console.log(e),this.setState(e)}},{key:"renderGame",value:function(){return i.a.createElement(i.a.Fragment,null,i.a.createElement(I,{size:50,ref:this.background,app:this}),i.a.createElement(M,{size:50,player:this.player,ref:this.monsters}),i.a.createElement(D,{size:50,player:this.player,ref:this.items}),i.a.createElement(w,{size:50,background:this.background,objects:this.monsters,ref:this.player,app:this,accessToken:this.state.accessToken,googleId:this.state.googleId,email:this.state.email,firstName:this.state.firstName,lastName:this.state.lastName}))}},{key:"renderInventory",value:function(){return i.a.createElement(V,{app:this,player:this.player,accessToken:this.state.accessToken,googleId:this.state.googleId,email:this.state.email,firstName:this.state.firstName,lastName:this.state.lastName})}},{key:"render",value:function(){return null===this.state.accessToken?this.renderLogin():"game"===this.state.page?this.renderGame():"inventory"===this.state.page?this.renderInventory():null}}]),n}(i.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(i.a.createElement(i.a.StrictMode,null,i.a.createElement(Y,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()})).catch((function(t){console.error(t.message)}))}},[[33,1,2]]]);
//# sourceMappingURL=main.91fb57d9.chunk.js.map