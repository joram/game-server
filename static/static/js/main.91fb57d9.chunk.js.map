{"version":3,"sources":["utils.js","web_socket.js","components/player.js","components/background.js","components/monsters.js","components/items.js","components/chat.js","components/player_editor.js","App.js","serviceWorker.js","index.js"],"names":["hostname","window","location","href","split","ws_prefix","http_prefix","sleep","ms","Promise","resolve","setTimeout","web_socket_connection","this","objectEventBus","require","url","console","log","ws","WebSocket","onopen","onmessage","evt","message","JSON","parse","data","processMessage","onclose","a","id","email","firstName","lastName","waitForConn","s","send","d","callback","readyState","msg","undefined","emit","Player","state","playerPosition","x","y","is_mounted","debouncedMovePlayer","_","debounce","key","e","wait","movePlayer","leading","maxWait","sendFullStateRequest","on","setState","nextPlayerPosition","type","props","background","current","updateChunks","as","app","setPage","sendPlayerMove","handleKeys","onKeyEvent","children","React","Component","Square","pixel","g","p","color","r","b","isSolid","style","width","height","left","chunkPosition","top","backgroundColor","position","Chunk","SIZE","chunk","pixels","forEach","push","squaresTall","Math","ceil","innerHeight","squaresWide","innerWidth","offsetX","floor","offsetY","className","border","size","backgroundSquares","Background","CHUNKSIZE","chunkData","objects","fetch","then","res","json","pp","minX","minY","maxX","maxY","chunksWide","chunksTall","xIndex","Array","keys","yIndex","requestChunk","solid","chunks","Object","Monster","monster","images","src","length","alt","z","zIndex","Monsters","monsters","object","action","values","makeObject","o","player","Item","item","is_carried","dropped_image","Items","items","bind","uuidv4","v4","ChatMessage","from","substr","SlotTypes","1","2","3","4","5","6","7","8","BACKPACK","GROUND","PlayerEditor","sendBackpackRequest","textAlign","float","DndProvider","backend","HTML5Backend","DraggableItem","useDrag","allowed_slot","end","monitor","dropResult","getDropResult","name","unequipItem","dropItem","equipItem","collect","isDragging","drag","preview","DragPreviewImage","connect","ref","ItemSlot","useDrop","accept","slot","drop","isOver","canDrop","BackpackSlot","GroundSlot","Backpack","PlayerEditorEquip","equipped_slot","silhouette_style","equipped_image","transform","right","Ground","App","accessToken","googleId","page","createRef","profileObj","givenName","familyName","sendAccessToken","margin","paddingTop","clientId","onSuccess","loginSuccess","isSignedIn","renderLogin","renderGame","renderInventory","Boolean","match","ReactDOM","render","StrictMode","document","getElementById","navigator","serviceWorker","ready","registration","unregister","catch","error"],"mappings":"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","file":"static/js/main.91fb57d9.chunk.js","sourcesContent":["function hostname() {\n    let hostname = window.location.href.split(\"/\")[2]\n    if(hostname===\"localhost:3000\"){\n        return \"localhost:2305\"\n    }\n    return hostname\n}\n\nfunction ws_prefix() {\n    if(hostname()===\"localhost:2305\"){\n        return \"ws\"\n    }\n    return \"wss\"\n}\n\nfunction http_prefix() {\n    if(hostname()===\"localhost:2305\"){\n        return \"http\"\n    }\n    return \"https\"\n}\n\nexport {hostname, ws_prefix, http_prefix}","import {hostname, ws_prefix} from \"./utils\";\n\nfunction sleep(ms) {\n    return new Promise(resolve => setTimeout(resolve, ms));\n}\n\nclass WebSocketConnection {\n\n    sendAccessToken(a,id, email,firstName, lastName){\n        this.waitForConn(\n            () => {\n                let s = `{\"accessToken\":\"${a}\", \"googleId\":\"${id}\", \"email\":\"${email}\", \"firstName\":\"${firstName}\", \"lastName\":\"${lastName}\"}`\n                this.ws.send(s)\n            })\n    }\n\n    sendBackpackRequest(){\n        this.waitForConn(\n            () => {\n                this.ws.send(`{\"backpack\":\"please\"}`)\n            }\n        )\n\n    }\n\n    sendFullStateRequest(){\n        this.waitForConn(\n            () => {\n                this.ws.send(`{\"full_state\":\"please\"}`)\n            }\n        )\n\n    }\n\n    sendPlayerMove(d){\n        this.waitForConn(\n            () => {\n                this.ws.send(`{\"direction\":\"${d}\"}`)\n            })\n    }\n\n    equipItem(id) {\n        this.waitForConn(\n            () => {\n                this.ws.send(`{\"equip_item\":${id}}`)\n            })\n    }\n\n    unequipItem(id) {\n        this.waitForConn(\n            () => {\n                this.ws.send(`{\"unequip_item\":${id}}`)\n            })\n    }\n\n    dropItem(id) {\n        this.waitForConn(\n            () => {\n                this.ws.send(`{\"drop_item\":${id}}`)\n            })\n    }\n\n    async waitForConn(callback){\n        while(this.ws.readyState !== 1){\n            await sleep(1);\n        }\n        callback()\n    }\n\n    processMessage(msg) {\n        // item\n        if(msg[\"equipped_image\"] !== undefined){\n            console.log(\"item\", msg)\n            this.objectEventBus.emit(\"item\", null, msg)\n            return\n        }\n\n        // player-id\n        if(msg[\"playerId\"] !== undefined){\n            this.objectEventBus.emit(\"player_id\", null, msg)\n            return\n        }\n\n        // monster update\n        if(msg[\"type\"] !== undefined){\n            console.log(\"monster\", msg)\n            this.objectEventBus.emit(\"monster\", null, msg)\n            return\n        }\n\n        console.log(\"unknown msg\", msg)\n\n    }\n\n    constructor() {\n        this.objectEventBus = require('js-event-bus')();\n\n        let url = `${ws_prefix()}://${hostname()}/objects`\n        console.log(url)\n        this.ws = new WebSocket(url)\n\n        this.ws.onopen = () => {\n            console.log('connected to generic ws')\n        }\n\n        this.ws.onmessage = evt => {\n            const message = JSON.parse(evt.data)\n            this.processMessage(message)\n        }\n\n        this.ws.onclose = () => {\n            console.log('disconnected generic ws')\n        }\n    }\n}\n\n\nlet web_socket_connection = new WebSocketConnection()\n\nexport default web_socket_connection","import React from \"react\";\nimport _ from \"lodash\";\nimport KeyboardEventHandler from \"react-keyboard-event-handler\";\nimport web_socket_connection from \"../web_socket\";\n\n\nclass Player extends React.Component {\n\n    state = {\n        id: undefined,\n        playerPosition: {x: 0, y: 0},\n    }\n    is_mounted = false\n\n    componentWillUnmount() {\n        this.is_mounted = false\n    }\n    componentDidMount() {\n        this.is_mounted = true\n        web_socket_connection.sendFullStateRequest()\n        console.log(\"player\", this.state.id, \" pos is\", this.state.playerPosition)\n        web_socket_connection.objectEventBus.on(\"player_id\", (msg) => {\n            if(!this.is_mounted)\n                return\n\n            let state = this.state\n            state.id = msg[\"playerId\"]\n            this.setState(state)\n        })\n\n        web_socket_connection.objectEventBus.on(\"monster\", (msg) => {\n            if(!this.is_mounted) return\n\n            if(msg[\"id\"] === this.state.id) {\n                let state = this.state\n                state.playerPosition.x = msg[\"x\"]\n                state.playerPosition.y = msg[\"y\"]\n                this.setState(state)\n            }\n\n            let state = this.state\n            let nextPlayerPosition = state.playerPosition\n            if(msg.type===\"player\"){\n                state.playerPosition = nextPlayerPosition\n                state.nextPlayerPosition = nextPlayerPosition\n                this.setState(state)\n                this.props.background.current.updateChunks()\n\n                let as = this.props.app.state;\n                as.playerPosition = nextPlayerPosition\n                this.props.app.setState(as)\n            }\n        })\n    }\n\n    movePlayer(key, e) {\n        if (key === \"e\") {\n            this.props.app.setPage(\"inventory\")\n        } else {\n            if (key === \"w\") key = \"up\"\n            if (key === \"a\") key = \"left\"\n            if (key === \"s\") key = \"down\"\n            if (key === \"d\") key = \"right\"\n            this.props.background.current.updateChunks()\n            web_socket_connection.sendPlayerMove(key)\n        }\n    }\n\n    debouncedMovePlayer = _.debounce( (key, e, wait) => {\n        this.movePlayer(key, e)\n    }, 350, {leading:true, maxWait:350})\n\n    render(){\n        return <>\n            <KeyboardEventHandler\n                handleKeys={[\"left\", \"right\", \"up\", \"down\", \"w\", \"a\", \"s\", \"d\", \"e\"]}\n                onKeyEvent={(key, e) => {\n                    this.debouncedMovePlayer(key, e, 100)\n                }}\n            />\n            { this.props.children }\n        </>\n    }\n}\n\nexport default Player","import React from \"react\";\nimport {hostname, http_prefix} from \"../utils\";\n\nclass Square extends React.Component {\n\n    isSolid(){\n        return this.props.pixel.g > 180\n    }\n\n    render() {\n        let p = this.props.pixel\n        let color = `rgb(${p.r}, ${p.g}, ${p.b})`\n        if (this.isSolid()) {\n            color = `rgb(0, 80, 0)`\n        }\n        return <div style={{\n                width: \"50px\",\n                height: \"50px\",\n                left: `${50*(p.x-this.props.chunkPosition.x)}px`,\n                top: `${50*(p.y-this.props.chunkPosition.y)}px`,\n                backgroundColor: color,\n                position: \"absolute\"\n            }}>\n                {/*({p.x}, {p.y})*/}\n            </div>\n    }\n}\n\nclass Chunk extends React.Component {\n    SIZE = 50;\n    chunk = {}\n    state = {}\n\n    backgroundSquares() {\n        let pixels = []\n        // if(this.chunk.pixels === null || this.chunk.pixels === undefined) { return [] }\n        this.props.data.pixels.forEach(pixel => {\n\n            pixels.push(<Square\n                key={pixel.x+\"_\"+pixel.y}\n                pixel={pixel}\n                chunkPosition={{x:this.props.data.x, y:this.props.data.y}}\n                playerPosition={this.props.playerPosition}\n            />)\n        })\n        return pixels\n    }\n\n    render() {\n        let x = this.props.x\n        let y = this.props.y\n        let size = 50;\n        let squaresTall = Math.ceil(window.innerHeight/size);\n        let squaresWide = Math.ceil(window.innerWidth/size);\n        let offsetX = -this.props.playerPosition.x + Math.floor(squaresWide/2)\n        let offsetY = -this.props.playerPosition.y + Math.floor(squaresTall/2)\n\n        return <div className=\"chunk\" style={{\n            // zIndex: \"0\",\n            position: \"absolute\",\n            border:\"solid thin black\",\n            width: `${this.SIZE*this.chunk.size}px`,\n            height: `${this.SIZE*this.chunk.size}px`,\n            backgroundColor: \"pink\",\n            left: size*(x+offsetX)+\"px\",\n            top: size*(y+offsetY)+\"px\",\n\n        }}>\n            <div className=\"squares\">{this.backgroundSquares()}</div>\n        </div>\n    }\n}\n\nclass Background extends React.Component {\n\n    CHUNKSIZE = 10\n\n    state = {\n        playerPosition: {x:-99, y:-99},\n        chunkData: {},\n    }\n\n    componentDidMount(props) {\n        this.updateChunks()\n    }\n\n    requestChunk(x, y) {\n        if (this.state.chunkData[`${x}_${y}`] !== undefined ){\n            return\n        }\n\n        // so we don't request again\n        let state = this.state\n        state.chunkData[`${x}_${y}`] = {pixels:[], objects:[]}\n        this.setState(state)\n\n        let url = `${http_prefix()}://${hostname()}/chunks?x=${x}&y=${y}`\n        fetch(url)\n            .then(res => res.json())\n            .then(chunkData => {\n                let state = this.state\n                state.chunkData[`${x}_${y}`] = chunkData\n                this.setState(state)\n            });\n    }\n\n    updateChunks(){\n        let size = 50;\n        let squaresTall = Math.ceil(window.innerHeight/size);\n        let squaresWide = Math.ceil(window.innerWidth/size);\n\n        let pp = this.playerPosition()\n        let minX = Math.floor(pp.x - squaresWide/2)\n        let minY = Math.floor(pp.y - squaresTall/2)\n        let maxX = Math.ceil(pp.x + squaresWide/2)\n        let maxY = Math.ceil(pp.y + squaresTall/2)\n\n        minX = minX - minX%this.CHUNKSIZE - this.CHUNKSIZE\n        minY = minY - minY%this.CHUNKSIZE - this.CHUNKSIZE\n        maxX = maxX + maxX%this.CHUNKSIZE + this.CHUNKSIZE\n        maxY = maxY + maxY%this.CHUNKSIZE + this.CHUNKSIZE\n\n        let chunksWide = Math.ceil((maxX-minX)/this.CHUNKSIZE)\n        let chunksTall = Math.ceil((maxY-minY)/this.CHUNKSIZE)\n\n        let xIndex = [...Array(chunksWide).keys()]\n        let yIndex = [...Array(chunksTall).keys()]\n        xIndex.forEach(x => {\n            yIndex.forEach(y => {\n                if (this.state.chunkData[`${x}_${y}`] === undefined ){\n                    this.requestChunk(minX+x*this.CHUNKSIZE,minY+y*this.CHUNKSIZE)\n                }\n           })\n        })\n    }\n\n    playerPosition() {\n        return this.props.app.playerPosition()\n    }\n\n    isSolidAt(p){\n\n        let x = Math.floor(p.x/this.CHUNKSIZE)*this.CHUNKSIZE\n        let y = Math.floor(p.y/this.CHUNKSIZE)*this.CHUNKSIZE\n        let chunk = this.state.chunkData[`${x}_${y}`]\n        if(chunk === undefined) {\n            return false\n        }\n        let solid = false\n\n        chunk.pixels.forEach(pixel => {\n            if(Math.ceil(p.x) === pixel.x && Math.ceil(p.y) === pixel.y){\n                if(pixel.g > 180){\n                    solid = true\n                }\n            }\n        })\n\n        // chunk.objects.forEach(object => {\n        //     if(Math.ceil(p.x) === object.x && Math.ceil(p.y) === object.y){\n        //          if(object.solid){\n        //             solid = true\n        //         }\n        //     }\n        // })\n\n        return solid\n    }\n\n    render() {\n        let chunks = [];\n        let keys = Object.keys(this.state.chunkData)\n        keys.forEach(key => {\n            let chunkData = this.state.chunkData[key]\n            let chunk = <Chunk\n                x={chunkData.x}\n                y={chunkData.y}\n                key={key}\n                playerPosition={this.playerPosition()}\n                data={chunkData}\n                objectEventBus={this.props.objectEventBus}\n            />;\n            chunks.push(chunk)\n        })\n\n        return (<div id=\"chunks\">\n            {chunks}\n        </div>);\n    }\n}\n\nexport default Background","import React from \"react\";\nimport {hostname, http_prefix} from \"../utils\";\nimport web_socket_connection from \"../web_socket\";\n\nclass Monster extends React.Component {\n\n    state = {\n        monster: {x:0, y:0}\n    }\n    is_mounted = false\n\n    isSolid(){\n        return this.props.monster.solid\n    }\n\n    constructor(props) {\n        super(props);\n        this.state.monster = props.monster\n    }\n\n    componentWillUnmount() {\n        this.is_mounted = false\n    }\n    componentDidMount() {\n        this.is_mounted = true\n        web_socket_connection.objectEventBus.on(\"monster\", monster => {\n            if(!this.is_mounted) return\n            if(this.props.id === monster.id){\n                let state = this.state\n                state.monster = monster\n                this.setState(state)\n            }\n        })\n    }\n\n    render() {\n        let p = this.state.monster\n        let s = this.props.size\n        let x = p.x\n        let y = p.y\n        let size = 50;\n        let squaresTall = Math.ceil(window.innerHeight/size);\n        let squaresWide = Math.ceil(window.innerWidth/size);\n        let offsetX = -this.props.playerPosition.x + Math.floor(squaresWide/2)\n        let offsetY = -this.props.playerPosition.y + Math.floor(squaresTall/2)\n\n        let images = []\n        p.images.forEach(src => {\n            images.push(<img style={{\n                width: `${s}px`,\n                height: `${s}px`,\n                position: \"absolute\",\n                left: \"0px\",\n                top: \"0px\",\n            }}\n                 key={`${p.id}_img_${images.length}`}\n                 src={`${http_prefix()}://${hostname()}${src}`}\n                 alt={this.props.monster.type}\n            />)\n\n        })\n        let z = 0\n        if(this.props.monster.type===\"player\"){\n            z = 10\n        }\n\n        return <div style={{\n            position: \"absolute\",\n            width: s+\"px\",\n            height: s+\"px\",\n            zIndex: z,\n            left:s*(x+offsetX)+\"px\",\n            top:s*(y+offsetY)+\"px\",\n        }}>\n            {images}\n        </div>\n    }\n}\n\nclass Monsters extends React.Component {\n    SIZE = 50\n\n    state = {\n        monsters: {}\n    }\n    is_mounted = false\n\n    componentWillUnmount() {\n        this.is_mounted = false\n    }\n    componentDidMount() {\n        this.is_mounted = true\n        web_socket_connection.objectEventBus.on(\"monster\", object => {\n            if(!this.is_mounted) return\n\n            let state = this.state\n            if (object.action === \"remove\") {\n                delete state.monsters[object.id]\n            } else {\n                state.monsters[object.id] = object\n            }\n            this.setState(state)\n        })\n    }\n\n    isSolidAt(p){\n        let solid = false\n        Object.values(this.state.monsters).forEach(monster => {\n            if(Math.ceil(p.x) === monster.x && Math.ceil(p.y) === monster.y){\n                 solid = solid || monster.solid\n            }\n        })\n        console.log(solid)\n        return solid\n    }\n\n    render() {\n\n        let playerPosition = {x:0, y:0}\n        if(this.props.player.current !== null){\n            playerPosition = this.props.player.current.state.playerPosition\n        }\n\n        function makeObject(o, size) {\n            return <Monster\n                monster={o}\n                key={o.id}\n                id={o.id}\n                size={size}\n                playerPosition={playerPosition}\n            />\n        }\n\n        let objects = [];\n        Object.values(this.state.monsters).forEach(o => {\n            if(o.type !== \"player\"){\n                objects.push(makeObject(o, this.SIZE))\n            }\n        })\n        Object.values(this.state.monsters).forEach(o => {\n            if(o.type === \"player\"){\n                objects.push(makeObject(o, this.SIZE))\n            }\n        })\n        return <div className=\"objects\">\n            {objects}\n        </div>\n    }\n\n\n}\n\nexport default Monsters","import React from \"react\";\nimport web_socket_connection from \"../web_socket\";\nimport {hostname, http_prefix} from \"../utils\";\n\nclass Item extends React.Component {\n\n    state = {\n        item: {x: 0, y: 0}\n    }\n    is_mounted = false\n\n    constructor(props) {\n        super(props);\n        this.state.item = props.item\n    }\n\n    componentWillUnmount() {\n        this.is_mounted = false\n    }\n    componentDidMount() {\n        this.is_mounted = true\n\n        web_socket_connection.objectEventBus.on(\"item\", item => {\n            if(!this.is_mounted) return\n            if (this.props.id === item.id) {\n                let state = this.state\n                state.item = item\n                this.setState(state)\n            }\n        })\n    }\n\n    render(){\n        if(this.state.item.is_carried){\n            return null\n        }\n\n        let p = this.state.item\n        let s = this.props.size\n        let x = p.x\n        let y = p.y\n        let size = 50;\n        let squaresTall = Math.ceil(window.innerHeight/size);\n        let squaresWide = Math.ceil(window.innerWidth/size);\n        let offsetX = -this.props.playerPosition.x + Math.floor(squaresWide/2)\n        let offsetY = -this.props.playerPosition.y + Math.floor(squaresTall/2)\n\n        return <div style={{\n            position: \"absolute\",\n            width: s+\"px\",\n            height: s+\"px\",\n            zIndex: 0,\n            left:s*(x+offsetX)+\"px\",\n            top:s*(y+offsetY)+\"px\",\n        }}>\n            <img style={{\n                width: `${s}px`,\n                height: `${s}px`,\n                position: \"absolute\",\n                left: \"0px\",\n                top: \"0px\",\n            }}\n            src={`${http_prefix()}://${hostname()}${this.props.item.dropped_image}`}\n            alt={this.props.item.type}\n            />\n        </div>\n    }\n}\n\nclass Items extends React.Component {\n    SIZE = 50\n\n    state = {\n        items: {}\n    }\n    is_mounted = false\n\n    componentWillUnmount() {\n        this.is_mounted = false\n    }\n    componentDidMount() {\n        this.is_mounted = true\n        web_socket_connection.objectEventBus.on(\"item\", item => {\n            if(!this.is_mounted) return\n            let state = this.state\n            if (item.action === \"remove\") {\n                delete state.items[item.id]\n            } else {\n                state.items[item.id] = item\n            }\n            this.setState(state)\n        })\n    }\n\n    render() {\n        let playerPosition = {x:0, y:0}\n        if(this.props.player.current !== null){\n            playerPosition = this.props.player.current.state.playerPosition\n        }\n\n        function makeObject(o, size) {\n            return <Item\n                playerPosition={playerPosition}\n                item={o}\n                key={o.id}\n                id={o.id}\n                size={size}\n            />\n        }\n\n        let objects = [];\n        Object.values(this.state.items).forEach(o => {\n            if(o.type !== \"player\"){\n                objects.push(makeObject.bind(this)(o, this.SIZE, this.props.objectEventBus))\n            }\n        })\n        Object.values(this.state.items).forEach(o => {\n            if(o.type === \"player\"){\n                objects.push(makeObject(o, this.SIZE, this.props.objectEventBus))\n            }\n        })\n        return <div className=\"objects\">\n            {objects}\n        </div>\n    }\n\n\n}\n\nexport default Items","import React from \"react\";\nimport {hostname, ws_prefix} from \"../utils\";\n\nconst { v4: uuidv4 } = require('uuid');\n\nclass ChatMessage extends React.Component {\n\n    render(){\n        return <div className=\"chat_message\" style={{color:\"white\"}}>{this.props.message.from.substr(1, 6)}: {this.props.message.message}</div>\n    }\n}\n\nclass Chat extends React.Component {\n    id = uuidv4();\n    ws = new WebSocket(`${ws_prefix()}://${hostname()}/chat`)\n    state = {\n        messages: [],\n        text: \"\",\n    }\n\n    componentDidMount() {\n        this.ws.onopen = () => {\n            // on connecting, do nothing but log it to the console\n            this.ws.send(`{\"id\":\"${this.id}\", \"message\":\"logged in\"}`)\n        }\n\n        this.ws.onmessage = evt => {\n            // on receiving a message, add it to the list of messages\n            const message = JSON.parse(evt.data)\n            let state = this.state\n            state.messages.push(message)\n            this.setState(state)\n        }\n\n        this.ws.onclose = () => {\n            console.log('disconnected')\n        }\n    }\n\n    sendMessage(e, msg){\n        e.preventDefault();\n        console.log(this.state.text)\n        this.ws.send(`{\"id\":\"${this.id}\", \"message\":\"${this.state.text}\"}`)\n        let state = this.state\n        state.text = \"\"\n        this.setState(state)\n    }\n\n    textChange(event) {\n        let state = this.state\n        state.text = event.target.value\n        this.setState(state)\n    }\n\n    render(){\n        let messages = [];\n        this.state.messages.forEach((msg, i) => {\n            messages.push(<ChatMessage key={`msg_${i}`} message={msg} />)\n        })\n\n        return <div style={{\n            width:\"300px\",\n            height:\"500px\",\n            backgroundColor: \"rgba(20,20,20,0.8)\",\n            position: \"absolute\",\n            top: \"10px\",\n            left: \"10px\",\n        }} >\n            <div style={{color:\"white\"}}>you are {this.id.substr(1, 6)}</div>\n            <div>\n                {messages}\n            </div>\n            <form onSubmit={this.sendMessage.bind(this)}>\n                <input type=\"text\"\n                       style={{\n                           bottom: \"6px\",\n                           left: \"5px\",\n                           width: \"185px\",\n                           position: \"absolute\"\n                       }}\n                       onChange={this.textChange.bind(this)}\n                       value={this.state.text}\n                />\n            </form>\n        </div>\n    }\n}\n\nexport default Chat","import React from \"react\";\nimport web_socket_connection from \"../web_socket\"\nimport { DndProvider,DragPreviewImage } from 'react-dnd'\nimport { HTML5Backend } from 'react-dnd-html5-backend'\nimport { useDrag } from 'react-dnd'\nimport { useDrop } from 'react-dnd'\nimport {hostname, http_prefix} from \"../utils\";\nimport KeyboardEventHandler from \"react-keyboard-event-handler\";\n\nconst SlotTypes = {\n    1: \"s1\",\n    2: \"s2\",\n    3: \"s3\",\n    4: \"s4\",\n    5: \"s5\",\n    6: \"s6\",\n    7: \"s7\",\n    8: \"s8\",\n    BACKPACK: \"backpack\",\n    GROUND: \"ground\",\n}\n\nclass PlayerEditor extends React.Component {\n\n    constructor(props) {\n        super(props);\n        web_socket_connection.sendBackpackRequest()\n    }\n\n    render() {\n        return <>\n            <div style={{textAlign:\"center\"}}>\n                <div style={{float:\"left\", width:\"300px\"}}>Equipped</div>\n                <div style={{float:\"left\", width:\"300px\"}}>Backpack</div>\n                <div style={{float:\"left\", width:\"300px\"}}>Ground</div>\n            </div>\n            <div  style={{top:\"20px\", position: \"absolute\"}} >\n                <DndProvider backend={HTML5Backend}>\n                    <PlayerEditorEquip />\n                    <Backpack />\n                    <Ground />\n                </DndProvider>\n            </div>\n            <KeyboardEventHandler\n                handleKeys={[\"esc\", \"e\"]}\n                onKeyEvent={(key, e) => {\n                    this.props.app.setPage(\"game\")\n                }}\n            />\n        </>\n    }\n}\n\n\nfunction DraggableItem(props) {\n    const [{ isDragging }, drag, preview] = useDrag({\n        item: { type: SlotTypes[props.item.allowed_slot] },\n        end: (item, monitor) => {\n            const dropResult = monitor.getDropResult()\n            if (item && dropResult) {\n                if(dropResult.name === \"backpack\") {\n                    web_socket_connection.unequipItem(props.item.id)\n                } else if(dropResult.name === \"ground\"){\n                    web_socket_connection.dropItem(props.item.id)\n                } else {\n                    web_socket_connection.equipItem(props.item.id)\n                }\n            }\n        },\n        collect: (monitor) => ({\n            isDragging: monitor.isDragging(),\n        }),\n    })\n    return <>\n        <DragPreviewImage connect={preview} src={props.item.dropped_image} />\n        <div ref={drag} style={{...props.style}}>\n            <img src={`${http_prefix()}://${hostname()}/${props.item.dropped_image}`} alt={props.item.name} />\n        </div>\n    </>\n}\n\n\nfunction ItemSlot(props) {\n    const [{ canDrop, isOver }, drop] = useDrop({\n        accept: SlotTypes[props.slot],\n        drop: () => ({ name: `slot ${props.slot}` }),\n        collect: (monitor) => ({\n            isOver: monitor.isOver(),\n            canDrop: monitor.canDrop(),\n        }),\n    })\n    const isActive = canDrop && isOver\n    let backgroundColor = '#222'\n    if (isActive) {\n        backgroundColor = 'darkgreen'\n    } else if (canDrop) {\n        backgroundColor = 'darkkhaki'\n    }\n\n    let item = null\n    if(props.item !== undefined) {\n        item = <DraggableItem item={props.item} style={{...props.style, top:\"10px\", left:\"10px\"}}/>\n    }\n\n    return <>\n        <div ref={drop} style={{...props.style, backgroundColor }}>\n            <img style={{\n                width:\"50px\",\n                height: \"50px\",\n            }}\n                 src={`${http_prefix()}://${hostname()}/images/gui/tab_unselected.png`}\n                 alt={`slot ${props.slot}`}\n            />\n        </div>\n        {item}\n    </>\n}\n\n\nfunction BackpackSlot(props) {\n    const [{ canDrop, isOver }, drop] = useDrop({\n        accept: Object.values(SlotTypes),\n        drop: () => ({ name: `backpack` }),\n        collect: (monitor) => ({\n            isOver: monitor.isOver(),\n            canDrop: monitor.canDrop(),\n        }),\n    })\n    const isActive = canDrop && isOver\n    let backgroundColor = '#222'\n    if (isActive) {\n        backgroundColor = 'darkgreen'\n    } else if (canDrop) {\n        backgroundColor = 'darkkhaki'\n    }\n\n    let item = null\n\n    return <>\n        <div ref={drop} style={{width:\"100%\", height:\"100%\", border:\"solid thin black\", backgroundColor }}>\n        </div>\n        {item}\n    </>\n}\n\nfunction GroundSlot(props) {\n    const [{ canDrop, isOver }, drop] = useDrop({\n        accept: Object.values(SlotTypes),\n        drop: () => ({ name: `ground` }),\n        collect: (monitor) => ({\n            isOver: monitor.isOver(),\n            canDrop: monitor.canDrop(),\n        }),\n    })\n    const isActive = canDrop && isOver\n    let backgroundColor = '#222'\n    if (isActive) {\n        backgroundColor = 'darkgreen'\n    } else if (canDrop) {\n        backgroundColor = 'darkkhaki'\n    }\n\n    let item = null\n\n    return <>\n        <div ref={drop} style={{width:\"100%\", height:\"100%\", border:\"solid thin black\", backgroundColor }}>\n        </div>\n        {item}\n    </>\n}\n\nclass Backpack extends React.Component {\n\n    state = {\n        items: {}\n    }\n    is_mounted = false\n\n    componentWillUnmount() {\n        this.is_mounted = false\n    }\n    componentDidMount() {\n        this.is_mounted = true\n        web_socket_connection.objectEventBus.on(\"item\", item => {\n            if(!this.is_mounted) return\n            let state = this.state\n            if(item[\"is_carried\"] && !item[\"is_equipped\"]) {\n                state.items[item.id] = item\n            } else {\n                delete state.items[item.id]\n            }\n            this.setState(state)\n        })\n    }\n\n    render() {\n        let items = []\n        Object.values(this.state.items).forEach( item => {\n            items.push(<DraggableItem item={item} key={item.id}/>)\n        })\n        return <div style={{left:\"300px\", width: \"300px\", height: \"290px\", position: \"absolute\", border: \"solid thin black\"}}>\n            <BackpackSlot />\n            <div style={{position:\"absolute\", top:0, left:0}}>\n                {items}\n            </div>\n        </div>\n    }\n}\n\nclass PlayerEditorEquip extends React.Component {\n\n    state = {\n        items: {}\n    }\n    is_mounted = false\n\n    componentWillUnmount() {\n        this.is_mounted = false\n    }\n    componentDidMount() {\n        this.is_mounted = true\n        web_socket_connection.objectEventBus.on(\"item\", item => {\n            if(!this.is_mounted) return\n            let state = this.state\n            if(item[\"is_carried\"] && item[\"is_equipped\"]) {\n                state.items[item.equipped_slot] = item\n            } else {\n                delete state.items[item.allowed_slot]\n            }\n            this.setState(state)\n        })\n    }\n\n    render() {\n        let silhouette_style = {\n            position: \"absolute\",\n            width: \"200px\",\n            height: \"200px\",\n            left:\"50px\",\n            top: \"40px\"\n        }\n        let items = []\n        Object.values(this.state.items).forEach(item => {\n            items.push(<img style={silhouette_style}\n                 src={`${http_prefix()}://${hostname()}/${item.equipped_image}`}\n                 alt=\"silhouette\"\n                 key={item.id}\n            />)\n        })\n        return <div style={{width:\"300px\", height:\"290px\", position:\"absolute\", border: \"solid thin black\"}}>\n            <img style={silhouette_style}\n                 src={`${http_prefix()}://${hostname()}/images/player/base/human_m.png`}\n                 alt=\"silhouette\"\n            />\n            {items}\n\n            <ItemSlot style={{position: \"absolute\", left: \"0px\"}} slot={1} item={this.state.items[1]}/>\n            <ItemSlot style={{position: \"absolute\", transform: \"scaleX(-1)\", right: \"0px\"}} slot={2} item={this.state.items[2]}/>\n\n            <div style={{position: \"absolute\", top:\"80px\", width:\"100%\"}}>\n                <ItemSlot style={{position: \"absolute\", left: \"0px\"}} slot={3} item={this.state.items[3]}/>\n                <ItemSlot style={{position: \"absolute\", transform: \"scaleX(-1)\", right: \"0px\"}} slot={4} item={this.state.items[4]}/>\n            </div>\n\n            <div style={{position: \"absolute\", top:\"160px\", width:\"100%\"}}>\n                <ItemSlot style={{position: \"absolute\", left: \"0px\"}} slot={5}/>\n                <ItemSlot style={{position: \"absolute\", transform: \"scaleX(-1)\", right: \"0px\"}} slot={6}/>\n            </div>\n\n            <div style={{position: \"absolute\", top:\"240px\", width:\"100%\"}}>\n                <ItemSlot style={{position: \"absolute\", left: \"0px\"}} slot={7}/>\n                <ItemSlot style={{position: \"absolute\", transform: \"scaleX(-1)\", right: \"0px\"}} slot={8}/>\n            </div>\n\n        </div>\n    }\n}\n\nclass Ground extends React.Component {\n\n    state = {\n        items: {}\n    }\n    is_mounted = false\n\n    componentWillUnmount() {\n        this.is_mounted = false\n    }\n    componentDidMount() {\n        this.is_mounted = true\n        web_socket_connection.objectEventBus.on(\"item\", item => {\n            if(!this.is_mounted) return\n            let state = this.state\n            if(!item[\"is_carried\"]) {\n                state.items[item.equipped_slot] = item\n            } else {\n                delete state.items[item.allowed_slot]\n                delete state.items[item.equipped_slot]\n                delete state.items[-1]\n            }\n            this.setState(state)\n        })\n    }\n\n    render() {\n        let items = []\n        Object.values(this.state.items).forEach( item => {\n            items.push(<DraggableItem item={item} key={item.id}/>)\n        })\n        return <div style={{left:\"600px\", width: \"300px\", height: \"290px\", position: \"absolute\", border: \"solid thin black\"}}>\n            <GroundSlot />\n            <div style={{position:\"absolute\", top:0, left:0}}>\n                {items}\n            </div>\n        </div>\n    }\n}\n\nexport default PlayerEditor","import React from 'react';\nimport GoogleLogin from 'react-google-login';\nimport './App.css';\nimport Player from \"./components/player\";\nimport Background from \"./components/background\";\nimport Monsters from \"./components/monsters\";\nimport Items from \"./components/items\";\nimport Chat from \"./components/chat\";\nimport PlayerEditor from \"./components/player_editor\";\nimport web_socket_connection from \"./web_socket\"\n\nclass App extends React.Component {\n\n    state = {\n        accessToken: null,\n        googleId: null,\n        email: \"\",\n        firstName: \"\",\n        lastName: \"\",\n        page: \"game\",\n    }\n\n    constructor(props) {\n        super(props);\n        this.background = React.createRef();\n        this.monsters = React.createRef();\n        this.items = React.createRef();\n        this.player = React.createRef();\n        // this.objectEventBus = require('js-event-bus')();\n    }\n\n    playerPosition() {\n        if(this.player.current===null){\n            return {x:0, y:0}\n        }\n        return this.player.current.state.playerPosition\n    }\n\n    loginSuccess(data){\n        let state = this.state\n        state.accessToken = data.accessToken\n        state.googleId = data.googleId\n        state.firstName = data.profileObj.givenName\n        state.lastName = data.profileObj.familyName\n        state.email = data.profileObj.email\n        web_socket_connection.sendAccessToken(state.accessToken, state.googleId, state.email, state.firstName, state.lastName)\n        this.setState(state)\n    }\n\n    renderLogin() {\n        return <div style={{margin:\"auto\", width:\"200px\", paddingTop:\"200px\"}}>\n            <GoogleLogin\n                clientId=\"662193159992-4fv4hq3q25mkerlt0eqqr1ii670ogugr.apps.googleusercontent.com\"\n                onSuccess={this.loginSuccess.bind(this)}\n                isSignedIn={true}\n            />\n        </div>\n    }\n\n    setPage(name){\n        let state = this.state\n        state.page = name\n        console.log(state)\n        this.setState(state)\n    }\n\n    renderGame() {\n        let size = 50;\n        return <>\n            <Background\n                size={size}\n                ref={this.background}\n                app={this}\n            />\n            <Monsters\n                size={size}\n                player={this.player}\n                ref={this.monsters}\n            />\n            <Items\n                size={size}\n                player={this.player}\n                ref={this.items}\n            />\n            <Player\n                size={size}\n                background={this.background}\n                objects={this.monsters}\n                ref={this.player}\n                app={this}\n                accessToken={this.state.accessToken}\n                googleId={this.state.googleId}\n                email={this.state.email}\n                firstName={this.state.firstName}\n                lastName={this.state.lastName}\n            />\n            {/*<Chat/>*/}\n        </>;\n    }\n\n    renderInventory(){\n        return <PlayerEditor\n            app={this}\n            player={this.player}\n            accessToken={this.state.accessToken}\n            googleId={this.state.googleId}\n            email={this.state.email}\n            firstName={this.state.firstName}\n            lastName={this.state.lastName}\n        />\n    }\n\n    render(){\n        if(this.state.accessToken === null)\n            return this.renderLogin()\n        if(this.state.page===\"game\")\n            return this.renderGame()\n        if(this.state.page===\"inventory\")\n            return this.renderInventory()\n        return null\n    }\n\n\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}